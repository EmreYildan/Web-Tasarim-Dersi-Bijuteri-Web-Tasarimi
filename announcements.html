<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="utf-8">
    <title>Duyurular - Emre Mücevherat</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
    <link rel="stylesheet" media="all" href="./css/style.css">
    <style>
        .announcements-page {
            padding: 60px 0;
        }
        
        .announcement-full {
            background: #fff;
            padding: 30px;
            margin-bottom: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .announcement-full h2 {
            color: #333;
            margin-bottom: 15px;
            font-size: 24px;
        }
        
        .announcement-meta {
            color: #999;
            font-size: 14px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .announcement-category {
            display: inline-block;
            padding: 4px 12px;
            background: #007bff;
            color: #fff;
            border-radius: 4px;
            font-size: 12px;
            margin-right: 10px;
        }
        
        .announcement-full .content {
            line-height: 1.8;
            color: #666;
        }
        
        .no-announcements {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }
    </style>
    <link rel="stylesheet" href="./css/chatbot.css">
</head>
<body>

    <header id="header">
        <div class="container">
            <a href="index.html" id="logo" title="Emre Mücevherat">Emre Mücevherat</a>
            <div class="right-links">
                <ul>
                    <li><a href="cart.html"><span class="ico-products"></span></a></li>
                    <li><a href="#"><span class="ico-account"></span>Hesap</a></li>
                    <li><a href="#"><span class="ico-signout"></span>Çıkış</a></li>
                </ul>
            </div>
        </div>
    </header>

    <nav id="menu" role="navigation" aria-label="Ana menü">
        <div class="container">
            <button class="trigger" aria-label="Menüyü aç/kapat" aria-expanded="false"></button>
            <ul role="menubar">
                <li role="none"><a href="index.html" role="menuitem">Ana Sayfa</a></li>
                <li class="menu-item has-submenu" role="none">
                    <a href="products.html" role="menuitem" aria-haspopup="true" aria-expanded="false">Ürünlerimiz</a>
                    <ul class="submenu" role="menu" aria-label="Ürün kategorileri">
                        <li role="none"><a href="new-collection.html" role="menuitem">Yeni Koleksiyon</a></li>
                        <li role="none"><a href="necklaces.html" role="menuitem">Kolyeler</a></li>
                        <li role="none"><a href="earrings.html" role="menuitem">Küpeler</a></li>
                        <li role="none"><a href="rings.html" role="menuitem">Yüzükler</a></li>
                    </ul>
                </li>

                <li class="menu-item has-submenu" role="none">
                    <a href="#birimlerimiz" role="menuitem" aria-haspopup="true" aria-expanded="false">Birimlerimiz</a>
                    <ul class="submenu" role="menu" aria-label="Birimlerimiz">
                        <li role="none"><a href="text-page.html#satis" role="menuitem">Satış Birimi</a></li>
                        <li role="none"><a href="text-page.html#musteri" role="menuitem">Müşteri Hizmetleri</a></li>
                        <li role="none"><a href="text-page.html#tasarim" role="menuitem">Tasarım Ekibi</a></li>
                    </ul>
                </li>

                <li role="none"><a href="about.html" role="menuitem">Hakkımızda</a></li>
                <li role="none"><a href="mission-vision.html" role="menuitem">Misyon-Vizyon</a></li>
                <li role="none"><a href="announcements.html" role="menuitem" aria-current="page">Duyurular</a></li>
                <li role="none"><a href="statistics.html" role="menuitem">İstatistikler</a></li>
                <li role="none"><a href="contact.html" role="menuitem">İletişim</a></li>
                <li role="none"><a href="cart.html" role="menuitem">Sepet</a></li>
            </ul>
        </div>
    </nav>

    <div id="breadcrumbs">
        <div class="container">
            <ul>
                <li><a href="index.html">Ana Sayfa</a></li>
                <li>Duyurular</li>
            </ul>
        </div>
    </div>

    <div id="body">
        <div class="container">
            <div class="announcements-page">
                <h1>Duyurular ve Haberler</h1>
                <div id="announcements-list">
                    <!-- Duyurular buraya yüklenecek -->
                </div>
            </div>
        </div>
    </div>

    <footer id="footer" role="contentinfo">
        <div class="container">
            <div class="cols">
                <div class="col">
                    <h3>Frequently Asked Questions</h3>
                    <ul>
                        <li><a href="#">Fusce eget dolor adipiscing </a></li>
                        <li><a href="#">Posuere nisl eu venenatis gravida</a></li>
                        <li><a href="#">Morbi dictum ligula mattis</a></li>
                        <li><a href="#">Etiam diam vel dolor luctus dapibus</a></li>
                        <li><a href="#">Vestibulum ultrices magna </a></li>
                    </ul>
                </div>
                <div class="col media">
                    <h3>Social media</h3>
                    <ul class="social">
                        <li><a href="#"><span class="ico ico-fb"></span>Facebook</a></li>
                        <li><a href="#"><span class="ico ico-tw"></span>Twitter</a></li>
                        <li><a href="#"><span class="ico ico-gp"></span>Google+</a></li>
                        <li><a href="#"><span class="ico ico-pi"></span>Pinterest</a></li>
                    </ul>
                </div>
                <div class="col contact">
                    <h3>İletişim Bilgileri</h3>
                    <p>Emre Mücevherat<br>Kocaeli Üniversitesi Teknoloji Fakültesi<br>Umuttepe Kampüsü, İzmit/Kocaeli</p>
                    <p><span class="ico ico-em"></span><a href="mailto:info@emremucevherat.com">info@emremucevherat.com</a></p>
                    <p><span class="ico ico-ph"></span>(0262) 303 10 00</p>
                </div>
                <div class="col newsletter">
                    <h3>Web Tasarım</h3>
                    <p>Bu web sitesi Kocaeli Üniversitesi Teknoloji Fakültesi Bilişim Sistemleri Mühendisliği öğrencisi Emre Yasin Yıldan tarafından tasarlanmıştır.</p>
                    <p><strong>TBL303 Web Tasarımı Dersi</strong><br>2025-2026 Güz Dönemi</p>
                </div>
                <div class="col">
                    <h3>Yönetim</h3>
                    <ul>
                        <li><a href="./admin/index.html" target="_blank">Admin Panel</a></li>
                    </ul>
                </div>
            </div>
            <p class="copy">Copyright 2025 Emre Mücevherat. All rights reserved.</p>
        </div>
        <!-- / container -->
    </footer>

    <script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
    <script>window.jQuery || document.write("<script src='./js/jquery-1.11.1.min.js'>\x3C/script>")</script>
    <script src="./js/plugins.js"></script>
    <script src="./js/main.js"></script>
    <script src="./js/chatbot.js"></script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        loadAllAnnouncements();
    });

    function loadAllAnnouncements() {
        const announcements = JSON.parse(localStorage.getItem('announcements')) || [];
        const activeAnnouncements = announcements
            .filter(a => a.active)
            .sort((a, b) => new Date(b.date) - new Date(a.date));

        const container = document.getElementById('announcements-list');

        if (activeAnnouncements.length === 0) {
            container.innerHTML = '<div class="no-announcements"><h3>Henüz duyuru bulunmamaktadır.</h3></div>';
            return;
        }

        const categoryNames = {
            'campaign': '🎁 Kampanya',
            'news': '📰 Haber',
            'announcement': '📢 Duyuru',
            'event': '🎉 Etkinlik'
        };

        container.innerHTML = activeAnnouncements.map(announcement => {
            const plainSnippet = announcement.content.replace(/<[^>]*>/g, '').substring(0, 160);
            const hasAttachment = announcement.file ? '<span style="margin-left:10px; font-size:12px; color:#555">📎 Ek</span>' : '';
            return `
                <div class="announcement-full" onclick="openAnnouncementModal(${announcement.id})" style="cursor:pointer">
                    <h2>${announcement.title}</h2>
                    <div class="announcement-meta">
                        <span class="announcement-category">${categoryNames[announcement.category] || announcement.category}</span>
                        <span>${new Date(announcement.date).toLocaleDateString('tr-TR', { year: 'numeric', month: 'long', day: 'numeric' })}</span>
                        ${hasAttachment}
                    </div>
                    <div class="content">
                        ${plainSnippet}... <em style="color:#007bff; font-size:12px">(Devamı için tıklayın)</em>
                    </div>
                </div>
            `;
        }).join('');

        if (activeAnnouncements.length < 5) {
            const info = document.createElement('div');
            info.style.margin = '20px 0';
            info.style.padding = '15px';
            info.style.background = '#fff3cd';
            info.style.border = '1px solid #ffeeba';
            info.style.borderRadius = '6px';
            info.style.color = '#856404';
            info.innerHTML = `<strong>Bilgi:</strong> Şu anda ${activeAnnouncements.length} aktif duyuru var. Minimum gereksinim: 5.`;
            container.prepend(info);
        }
    }

    // Modal HTML ekle
    const modalHtml = `
    <div id="announcement-modal" class="modal" style="display:none;">
        <div class="modal-overlay"></div>
        <div class="modal-content" style="max-width:760px;">
            <div class="modal-header">
                <h3 id="modal-title"></h3>
                <span class="modal-close" style="cursor:pointer;">&times;</span>
            </div>
            <div class="modal-body" id="modal-body" style="padding:25px; line-height:1.6;"></div>
        </div>
    </div>`;
    document.body.insertAdjacentHTML('beforeend', modalHtml);

    function openAnnouncementModal(id){
        const announcements = JSON.parse(localStorage.getItem('announcements')) || [];
        const announcement = announcements.find(a => a.id === id);
        if(!announcement) return;
        document.getElementById('modal-title').textContent = announcement.title;
        let bodyHtml = '';
        if(announcement.image){
            bodyHtml += `<img src="${announcement.image}" alt="${announcement.title}" style="max-width:100%; border-radius:8px; margin-bottom:20px;">`;
        }
        bodyHtml += `<div style="margin-bottom:20px;">${announcement.content}</div>`;
        bodyHtml += `<p><strong>Tarih:</strong> ${new Date(announcement.date).toLocaleDateString('tr-TR', { year: 'numeric', month: 'long', day: 'numeric' })}</p>`;
        if(announcement.file){
            // Data URL veya harici link olabilir
            const isData = announcement.file.startsWith('data:');
            const downloadName = `${announcement.title.replace(/[^a-z0-9ğüşöçıİĞÜŞÖÇ\s]/gi,'_')}`;
            if(isData){
                bodyHtml += `<p><strong>Ek Dosya:</strong> <a href="${announcement.file}" download="${downloadName}" target="_blank">İndir</a></p>`;
            } else {
                bodyHtml += `<p><strong>Ek Dosya:</strong> <a href="${announcement.file}" target="_blank">Aç / İndir</a></p>`;
            }
        }
        document.getElementById('modal-body').innerHTML = bodyHtml;
        document.getElementById('announcement-modal').style.display = 'flex';
    }

    function closeAnnouncementModal(){
        document.getElementById('announcement-modal').style.display = 'none';
    }

    document.addEventListener('click', function(e){
        if(e.target.classList.contains('modal-close') || e.target.classList.contains('modal-overlay')){
            closeAnnouncementModal();
        }
    });
    </script>
</body>
</html>